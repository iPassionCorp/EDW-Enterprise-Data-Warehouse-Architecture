*** Settings ***
Library           DatabaseLibrary
Resource          ../../keywords/edm.txt
Resource          ../../Repositories/${env}/${dbname}_${env}_Connection.txt

*** Test Cases ***
EDW1_SIT_s_stg_tb_oacm_0001_0001_Validate policyNo_Length
    EDM_Connect_DB
    @{Result}    Query    select count(0) from ( select a.policyno,a.partnercode,c.partnercode FROM dm.creditmortgage a \ \ inner join dm.tlpmigration b on a.policyno = b.migrateplancode and a.cert = b.tlipolicyno \ \ inner join lookup.billingmapping c on b.tlppolicyno = c.tlpplncode \ where a.partnercode <> c.partnercode) tmp
    EDM_Compare Result    @{Result[0]}    0    policyNo

EDW1_SIT_s_stg_tb_oacm_0001_0002_Validate policyNo_NotNullNotBlank
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ FROM dm.creditmortgage a \ \ inner join dm.tlpmigration b on a.policyno = b.migrateplancode and a.cert = b.tlipolicyno \ \ inner join lookup.billingmapping c on b.tlppolicyno = c.tlpplncode \ where a.partnercode is \ null or a.partnercode = '' or a.partnercode = 'blank'
    EDM_Compare Result    @{Result[0]}    0    policyNo

EDW1_SIT_s_stg_tb_oacm_0001_0003_Validate Partnercode_Length
    EDM_Connect_DB
    @{Result}    Query    select count(0) \ FROM dm.creditmortgage a \ \ inner join dm.tlpmigration b on a.policyno = b.migrateplancode and a.cert = b.tlipolicyno \ \ inner join lookup.billingmapping c on b.tlppolicyno = c.tlpplncode \ where length (a.partnercode) <> 3 and a.partnercode != ''
    EDM_Compare Result    @{Result[0]}    0    partnercode
